<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Text Parser Tool</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; max-width: 800px; margin: auto; }
    textarea, input, select { width: 100%; padding: 8px; margin: 5px 0; box-sizing: border-box; }
    button { padding: 10px 20px; margin-top: 10px; cursor: pointer; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background-color: #f4f4f4; }
    .hidden { display: none; }
    a { color: blue; text-decoration: underline; }
  </style>
</head>
<body>

  <h2>üîç Text Parser Tool</h2>

  <label for="textInput">Paste your text:</label>
  <textarea id="textInput" placeholder="Enter or paste your text here..." rows="10"></textarea>

  <label for="modeSelect">Choose Extraction Type:</label>
  <select id="modeSelect" onchange="toggleInputMode()">
    <option value="url" selected>Extract URLs (websites)</option>
    <option value="custom">Custom Start & End Strings</option>
  </select>

  <div id="customInputs" class="hidden">
    <label for="startTag">Start string:</label>
    <input id="startTag" type="text" placeholder="e.g., <title>">

    <label for="endTag">End string:</label>
    <input id="endTag" type="text" placeholder="e.g., </title>">
  </div>

  <button onclick="extractText()">Extract</button>

  <div id="saveSection" class="hidden">
    <label for="saveName">Save As:</label>
    <input id="saveName" type="text" placeholder="Enter a name for your save">
    <button onclick="saveResult()">üíæ Save Result</button>
  </div>

  <div>
    <label for="savedData">Load Saved:</label>
    <select id="savedData" onchange="loadSaved()">
      <option value="">-- Select a saved item --</option>
    </select>
  </div>

  <table id="resultsTable" class="hidden">
    <thead>
      <tr>
        <th>#</th>
        <th>Extracted Text</th>
      </tr>
    </thead>
    <tbody id="resultsBody"></tbody>
  </table>

  <script>
    function toggleInputMode() {
      const mode = document.getElementById("modeSelect").value;
      document.getElementById("customInputs").classList.toggle("hidden", mode !== "custom");
    }

    function extractText() {
      const mode = document.getElementById("modeSelect").value;
      const inputText = document.getElementById("textInput").value;
      let results = [];

      if (mode === "url") {
        const urlRegex = /(https?:\/\/[^\s]+)/g;
        results = inputText.match(urlRegex) || [];
      } else {
        const start = document.getElementById("startTag").value;
        const end = document.getElementById("endTag").value;
        if (!start || !end) {
          alert("Please enter both start and end strings.");
          return;
        }
        const regex = new RegExp(start + "(.*?)" + end, "gs");
        let match;
        while ((match = regex.exec(inputText)) !== null) {
          results.push(match[1].trim());
        }
      }

      const resultsBody = document.getElementById("resultsBody");
      resultsBody.innerHTML = "";
      results.forEach((res, index) => {
        const row = `<tr><td>${index + 1}</td><td>${res}</td></tr>`;
        resultsBody.insertAdjacentHTML("beforeend", row);
      });

      document.getElementById("resultsTable").classList.toggle("hidden", results.length === 0);
      document.getElementById("saveSection").classList.toggle("hidden", results.length === 0);

      // Store in memory temporarily
      window.currentExtracted = results;
    }

    function saveResult() {
      const name = document.getElementById("saveName").value.trim();
      if (!name) {
        alert("Please enter a name to save your data.");
        return;
      }
      const data = window.currentExtracted || [];
      localStorage.setItem("parser_save_" + name, JSON.stringify(data));
      alert("Saved successfully as '" + name + "'!");
      populateSavedList();
      document.getElementById("saveName").value = "";
    }

    function populateSavedList() {
      const savedData = document.getElementById("savedData");
      savedData.innerHTML = `<option value="">-- Select a saved item --</option>`;
      for (let key in localStorage) {
        if (key.startsWith("parser_save_")) {
          const name = key.replace("parser_save_", "");
          savedData.insertAdjacentHTML("beforeend", `<option value="${key}">${name}</option>`);
        }
      }
    }

    function loadSaved() {
      const key = document.getElementById("savedData").value;
      if (!key) return;

      const data = JSON.parse(localStorage.getItem(key)) || [];
      const resultsBody = document.getElementById("resultsBody");
      resultsBody.innerHTML = "";

      data.forEach((res, index) => {
        const row = `<tr><td>${index + 1}</td><td>${res}</td></tr>`;
        resultsBody.insertAdjacentHTML("beforeend", row);
      });

      document.getElementById("resultsTable").classList.remove("hidden");
    }

    window.onload = populateSavedList;
  </script>

</body>
</html>
